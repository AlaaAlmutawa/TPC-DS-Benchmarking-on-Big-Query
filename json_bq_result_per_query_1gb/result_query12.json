{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon6cd6855e_ae54_4816_8505_8103e7d7127b" }, "priority": "INTERACTIVE", "query": "-- start query 12 in stream 0 using template query12.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ws_ext_sales_price) as itemrevenue \n ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n \t,item \n \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n \tand i_category in ('Sports', 'Books', 'Home')\n \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100\n;\n\n-- end query 12 in stream 0 using template query12.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "d3omgTguceNs1cvyBiSyuQ==", "id": "test-project-364309:europe-west1.query12_1665768233", "jobReference": { "jobId": "query12_1665768233", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query12_1665768233?location=europe-west1", "statistics": { "creationTime": "1665768234494", "endTime": "1665768235105", "finalExecutionDurationMs": "450", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "27095883", "performanceInsights": { "avgPreviousExecutionMs": "486" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04391891891891892, "computeRatioMax": 0.04391891891891892, "endMs": "1665768234657", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02027027027027027, "readRatioMax": 0.02027027027027027, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665768234618", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033783783783783786, "waitRatioMax": 0.0033783783783783786, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.0472972972972973, "writeRatioMax": 0.0472972972972973 }, { "completedParallelInputs": "1", "computeMsAvg": "46", "computeMsMax": "46", "computeRatioAvg": 0.1554054054054054, "computeRatioMax": 0.1554054054054054, "endMs": "1665768234695", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "18", "readMsMax": "18", "readRatioAvg": 0.060810810810810814, "readRatioMax": 0.060810810810810814, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "82", "startMs": "1665768234635", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033783783783783786, "waitRatioMax": 0.0033783783783783786, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.037162162162162164, "writeRatioMax": 0.037162162162162164 }, { "completedParallelInputs": "1", "computeMsAvg": "296", "computeMsMax": "296", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665768234874", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.05067567567567568, "readRatioMax": 0.05067567567567568, "recordsRead": "724738", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "196", "startMs": "1665768234705", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033783783783783786, "waitRatioMax": 0.0033783783783783786, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.02027027027027027, "writeRatioMax": 0.02027027027027027 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04054054054054054, "computeRatioMax": 0.04054054054054054, "endMs": "1665768234902", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "17", "startMs": "1665768234885", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033783783783783786, "waitRatioMax": 0.0033783783783783786, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.016891891891891893, "writeRatioMax": 0.016891891891891893 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02364864864864865, "computeRatioMax": 0.02364864864864865, "endMs": "1665768234971", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "34", "startMs": "1665768234929", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0033783783783783786, "waitRatioMax": 0.0033783783783783786, "writeMsAvg": "23", "writeMsMax": "23", "writeRatioAvg": 0.0777027027027027, "writeRatioMax": 0.0777027027027027 }, { "completedParallelInputs": "97", "computeMsAvg": "8", "computeMsMax": "13", "computeRatioAvg": 0.02702702702702703, "computeRatioMax": 0.04391891891891892, "endMs": "1665768235027", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3175", "startMs": "1665768234982", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0033783783783783786, "waitRatioMax": 0.006756756756756757, "writeMsAvg": "14", "writeMsMax": "17", "writeRatioAvg": 0.0472972972972973, "writeRatioMax": 0.057432432432432436 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "14", "computeRatioAvg": 0.02702702702702703, "computeRatioMax": 0.0472972972972973, "endMs": "1665768235027", "id": "8", "inputStages": [ "7", "4" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "280723", "shuffleOutputBytesSpilled": "0", "slotMs": "2306", "startMs": "1665768234987", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.010135135135135136, "waitRatioMax": 0.013513513513513514, "writeMsAvg": "12", "writeMsMax": "18", "writeRatioAvg": 0.04054054054054054, "writeRatioMax": 0.060810810810810814 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.02364864864864865, "computeRatioMax": 0.02364864864864865, "endMs": "1665768235039", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "100", "shuffleOutputBytes": "20187", "shuffleOutputBytesSpilled": "0", "slotMs": "17", "startMs": "1665768234996", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.010135135135135136, "waitRatioMax": 0.010135135135135136, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.013513513513513514, "writeRatioMax": 0.013513513513513514 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "204", "elapsedMs": "542", "estimatedRunnableUnits": "0", "pendingUnits": "3", "totalSlotMs": "5866" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "27095883", "totalPartitionsProcessed": "0", "totalSlotMs": "5866", "transferredBytes": "0" }, "startTime": "1665768234525", "totalBytesProcessed": "27095883", "totalSlotMs": "5866" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon46f8a037_23c0_4a9d_93e4_fe25167ba368" }, "priority": "INTERACTIVE", "query": "-- start query 12 in stream 0 using template query12.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ws_ext_sales_price) as itemrevenue \n ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n \t,item \n \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n \tand i_category in ('Sports', 'Books', 'Home')\n \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100\n;\n\n-- end query 12 in stream 0 using template query12.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "VVNyP8X/fdWIStFbAJ2Jeg==", "id": "test-project-364309:europe-west1.query12_1665776575", "jobReference": { "jobId": "query12_1665776575", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query12_1665776575?location=europe-west1", "statistics": { "creationTime": "1665776576453", "endTime": "1665776577132", "finalExecutionDurationMs": "470", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "27095883", "performanceInsights": { "avgPreviousExecutionMs": "481" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.05309734513274336, "computeRatioMax": 0.05309734513274336, "endMs": "1665776576641", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.02654867256637168, "readRatioMax": 0.02654867256637168, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776576612", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029498525073746312, "waitRatioMax": 0.0029498525073746312, "writeMsAvg": "9", "writeMsMax": "9", "writeRatioAvg": 0.02654867256637168, "writeRatioMax": 0.02654867256637168 }, { "completedParallelInputs": "1", "computeMsAvg": "23", "computeMsMax": "23", "computeRatioAvg": 0.06784660766961652, "computeRatioMax": 0.06784660766961652, "endMs": "1665776576660", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.02654867256637168, "readRatioMax": 0.02654867256637168, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776576626", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029498525073746312, "waitRatioMax": 0.0029498525073746312, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02359882005899705, "writeRatioMax": 0.02359882005899705 }, { "completedParallelInputs": "1", "computeMsAvg": "339", "computeMsMax": "339", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776576889", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "21", "readMsMax": "21", "readRatioAvg": 0.061946902654867256, "readRatioMax": 0.061946902654867256, "recordsRead": "724738", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "479", "startMs": "1665776576681", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029498525073746312, "waitRatioMax": 0.0029498525073746312, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.02064896755162242, "writeRatioMax": 0.02064896755162242 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.032448377581120944, "computeRatioMax": 0.032448377581120944, "endMs": "1665776576910", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665776576897", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029498525073746312, "waitRatioMax": 0.0029498525073746312, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.011799410029498525, "writeRatioMax": 0.011799410029498525 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.014749262536873156, "computeRatioMax": 0.014749262536873156, "endMs": "1665776576962", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "56", "startMs": "1665776576931", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0029498525073746312, "waitRatioMax": 0.0029498525073746312, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04424778761061947, "writeRatioMax": 0.04424778761061947 }, { "completedParallelInputs": "99", "computeMsAvg": "8", "computeMsMax": "19", "computeRatioAvg": 0.02359882005899705, "computeRatioMax": 0.05604719764011799, "endMs": "1665776577029", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "4930", "startMs": "1665776576973", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.0029498525073746312, "waitRatioMax": 0.0058997050147492625, "writeMsAvg": "15", "writeMsMax": "27", "writeRatioAvg": 0.04424778761061947, "writeRatioMax": 0.07964601769911504 }, { "completedParallelInputs": "101", "computeMsAvg": "7", "computeMsMax": "12", "computeRatioAvg": 0.02064896755162242, "computeRatioMax": 0.035398230088495575, "endMs": "1665776577028", "id": "8", "inputStages": [ "4", "7" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "280723", "shuffleOutputBytesSpilled": "0", "slotMs": "4254", "startMs": "1665776576979", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.011799410029498525, "waitRatioMax": 0.014749262536873156, "writeMsAvg": "13", "writeMsMax": "20", "writeRatioAvg": 0.038348082595870206, "writeRatioMax": 0.058997050147492625 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.029498525073746312, "computeRatioMax": 0.029498525073746312, "endMs": "1665776577041", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "100", "shuffleOutputBytes": "20187", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665776576988", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.008849557522123894, "waitRatioMax": 0.008849557522123894, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.011799410029498525, "writeRatioMax": 0.011799410029498525 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "206", "elapsedMs": "571", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "9781" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "27095883", "totalPartitionsProcessed": "0", "totalSlotMs": "9781", "transferredBytes": "0" }, "startTime": "1665776576511", "totalBytesProcessed": "27095883", "totalSlotMs": "9781" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon3715d5f5_e7f6_4072_acb8_eb00ba18d681" }, "priority": "INTERACTIVE", "query": "-- start query 12 in stream 0 using template query12.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ws_ext_sales_price) as itemrevenue \n ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n \t,item \n \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n \tand i_category in ('Sports', 'Books', 'Home')\n \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100\n;\n\n-- end query 12 in stream 0 using template query12.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "8l+5BoNFiiY+oFKrfwBvQA==", "id": "test-project-364309:europe-west1.query12_1665776578", "jobReference": { "jobId": "query12_1665776578", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query12_1665776578?location=europe-west1", "statistics": { "creationTime": "1665776578958", "endTime": "1665776579723", "finalExecutionDurationMs": "588", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "27095883", "performanceInsights": { "avgPreviousExecutionMs": "480" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "21", "computeMsMax": "21", "computeRatioAvg": 0.06752411575562701, "computeRatioMax": 0.06752411575562701, "endMs": "1665776579150", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.028938906752411574, "readRatioMax": 0.028938906752411574, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "81", "startMs": "1665776579100", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006430868167202572, "waitRatioMax": 0.006430868167202572, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.04823151125401929, "writeRatioMax": 0.04823151125401929 }, { "completedParallelInputs": "1", "computeMsAvg": "58", "computeMsMax": "58", "computeRatioAvg": 0.1864951768488746, "computeRatioMax": 0.1864951768488746, "endMs": "1665776579191", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.05144694533762058, "readRatioMax": 0.05144694533762058, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "124", "startMs": "1665776579124", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.022508038585209004, "waitRatioMax": 0.022508038585209004, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.04180064308681672, "writeRatioMax": 0.04180064308681672 }, { "completedParallelInputs": "1", "computeMsAvg": "311", "computeMsMax": "311", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776579392", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.06430868167202572, "readRatioMax": 0.06430868167202572, "recordsRead": "724738", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "346", "startMs": "1665776579211", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "7", "waitMsMax": "7", "waitRatioAvg": 0.022508038585209004, "waitRatioMax": 0.022508038585209004, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.01607717041800643, "writeRatioMax": 0.01607717041800643 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.04823151125401929, "computeRatioMax": 0.04823151125401929, "endMs": "1665776579470", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "28", "startMs": "1665776579451", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.006430868167202572, "waitRatioMax": 0.006430868167202572, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.01929260450160772, "writeRatioMax": 0.01929260450160772 }, { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.028938906752411574, "computeRatioMax": 0.028938906752411574, "endMs": "1665776579556", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776579506", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.00964630225080386, "waitRatioMax": 0.00964630225080386, "writeMsAvg": "31", "writeMsMax": "31", "writeRatioAvg": 0.09967845659163987, "writeRatioMax": 0.09967845659163987 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "15", "computeRatioAvg": 0.02572347266881029, "computeRatioMax": 0.04823151125401929, "endMs": "1665776579636", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "6115", "startMs": "1665776579563", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.006430868167202572, "waitRatioMax": 0.00964630225080386, "writeMsAvg": "17", "writeMsMax": "30", "writeRatioAvg": 0.05466237942122187, "writeRatioMax": 0.09646302250803858 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.028938906752411574, "computeRatioMax": 0.05787781350482315, "endMs": "1665776579636", "id": "8", "inputStages": [ "7", "4" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "280723", "shuffleOutputBytesSpilled": "0", "slotMs": "4868", "startMs": "1665776579571", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "4", "waitMsMax": "5", "waitRatioAvg": 0.012861736334405145, "waitRatioMax": 0.01607717041800643, "writeMsAvg": "17", "writeMsMax": "29", "writeRatioAvg": 0.05466237942122187, "writeRatioMax": 0.0932475884244373 }, { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.04180064308681672, "computeRatioMax": 0.04180064308681672, "endMs": "1665776579639", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "100", "shuffleOutputBytes": "20187", "shuffleOutputBytesSpilled": "0", "slotMs": "54", "startMs": "1665776579587", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.01607717041800643, "waitRatioMax": 0.01607717041800643, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02572347266881029, "writeRatioMax": 0.02572347266881029 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "173", "completedUnits": "32", "elapsedMs": "610", "estimatedRunnableUnits": "0", "pendingUnits": "175", "totalSlotMs": "2481" }, { "activeUnits": "164", "completedUnits": "207", "elapsedMs": "682", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "11692" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "27095883", "totalPartitionsProcessed": "0", "totalSlotMs": "11692", "transferredBytes": "0" }, "startTime": "1665776579000", "totalBytesProcessed": "27095883", "totalSlotMs": "11692" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonaebc119b_41c3_4ea6_b844_59ce77af9525" }, "priority": "INTERACTIVE", "query": "-- start query 12 in stream 0 using template query12.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ws_ext_sales_price) as itemrevenue \n ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n \t,item \n \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n \tand i_category in ('Sports', 'Books', 'Home')\n \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100\n;\n\n-- end query 12 in stream 0 using template query12.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "6bAh/zAJXGJhc2kNT5RdPA==", "id": "test-project-364309:europe-west1.query12_1665776581", "jobReference": { "jobId": "query12_1665776581", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query12_1665776581?location=europe-west1", "statistics": { "creationTime": "1665776581649", "endTime": "1665776582298", "finalExecutionDurationMs": "434", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "27095883", "performanceInsights": { "avgPreviousExecutionMs": "492" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "13", "computeMsMax": "13", "computeRatioAvg": 0.06220095693779904, "computeRatioMax": 0.06220095693779904, "endMs": "1665776581848", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.028708133971291867, "readRatioMax": 0.028708133971291867, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776581817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004784688995215311, "waitRatioMax": 0.004784688995215311, "writeMsAvg": "15", "writeMsMax": "15", "writeRatioAvg": 0.07177033492822966, "writeRatioMax": 0.07177033492822966 }, { "completedParallelInputs": "1", "computeMsAvg": "29", "computeMsMax": "29", "computeRatioAvg": 0.13875598086124402, "computeRatioMax": 0.13875598086124402, "endMs": "1665776581874", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.04784688995215311, "readRatioMax": 0.04784688995215311, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "87", "startMs": "1665776581830", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004784688995215311, "waitRatioMax": 0.004784688995215311, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.06698564593301436, "writeRatioMax": 0.06698564593301436 }, { "completedParallelInputs": "1", "computeMsAvg": "209", "computeMsMax": "209", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776582031", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.06220095693779904, "readRatioMax": 0.06220095693779904, "recordsRead": "724738", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "298", "startMs": "1665776581884", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004784688995215311, "waitRatioMax": 0.004784688995215311, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.023923444976076555, "writeRatioMax": 0.023923444976076555 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.03349282296650718, "computeRatioMax": 0.03349282296650718, "endMs": "1665776582079", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "22", "startMs": "1665776582067", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.004784688995215311, "waitRatioMax": 0.004784688995215311, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.019138755980861243, "writeRatioMax": 0.019138755980861243 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.04784688995215311, "computeRatioMax": 0.04784688995215311, "endMs": "1665776582133", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "61", "startMs": "1665776582098", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009569377990430622, "waitRatioMax": 0.009569377990430622, "writeMsAvg": "17", "writeMsMax": "17", "writeRatioAvg": 0.08133971291866028, "writeRatioMax": 0.08133971291866028 }, { "completedParallelInputs": "75", "computeMsAvg": "7", "computeMsMax": "14", "computeRatioAvg": 0.03349282296650718, "computeRatioMax": 0.06698564593301436, "endMs": "1665776582198", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3733", "startMs": "1665776582144", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "2", "waitRatioAvg": 0.004784688995215311, "waitRatioMax": 0.009569377990430622, "writeMsAvg": "15", "writeMsMax": "31", "writeRatioAvg": 0.07177033492822966, "writeRatioMax": 0.14832535885167464 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "18", "computeRatioAvg": 0.0430622009569378, "computeRatioMax": 0.0861244019138756, "endMs": "1665776582198", "id": "8", "inputStages": [ "4", "7" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "280723", "shuffleOutputBytesSpilled": "0", "slotMs": "4778", "startMs": "1665776582150", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.014354066985645933, "waitRatioMax": 0.019138755980861243, "writeMsAvg": "15", "writeMsMax": "29", "writeRatioAvg": 0.07177033492822966, "writeRatioMax": 0.13875598086124402 }, { "completedParallelInputs": "1", "computeMsAvg": "8", "computeMsMax": "8", "computeRatioAvg": 0.03827751196172249, "computeRatioMax": 0.03827751196172249, "endMs": "1665776582214", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "100", "shuffleOutputBytes": "20187", "shuffleOutputBytesSpilled": "0", "slotMs": "31", "startMs": "1665776582159", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.009569377990430622, "waitRatioMax": 0.009569377990430622, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.028708133971291867, "writeRatioMax": 0.028708133971291867 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "182", "elapsedMs": "534", "estimatedRunnableUnits": "0", "pendingUnits": "25", "totalSlotMs": "9052" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "27095883", "totalPartitionsProcessed": "0", "totalSlotMs": "9052", "transferredBytes": "0" }, "startTime": "1665776581715", "totalBytesProcessed": "27095883", "totalSlotMs": "9052" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
BigQuery error in show operation: Not found: Job test-project-364309:europe- west1.query12_1665776583
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon076d19a1_cd16_44b8_a3e3_d516bedbc0e6" }, "priority": "INTERACTIVE", "query": "-- start query 12 in stream 0 using template query12.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ws_ext_sales_price) as itemrevenue \n ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n \t,item \n \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n \tand i_category in ('Sports', 'Books', 'Home')\n \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100\n;\n\n-- end query 12 in stream 0 using template query12.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "K5/zsH1v8T+1ccLD28VfrA==", "id": "test-project-364309:europe-west1.query12_1665776842", "jobReference": { "jobId": "query12_1665776842", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query12_1665776842?location=europe-west1", "statistics": { "creationTime": "1665776843033", "endTime": "1665776843745", "finalExecutionDurationMs": "510", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "27095883", "performanceInsights": { "avgPreviousExecutionMs": "486" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "9", "computeMsMax": "9", "computeRatioAvg": 0.024456521739130436, "computeRatioMax": 0.024456521739130436, "endMs": "1665776843223", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.01358695652173913, "readRatioMax": 0.01358695652173913, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776843182", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002717391304347826, "waitRatioMax": 0.002717391304347826, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.03804347826086957, "writeRatioMax": 0.03804347826086957 }, { "completedParallelInputs": "1", "computeMsAvg": "27", "computeMsMax": "27", "computeRatioAvg": 0.07336956521739131, "computeRatioMax": 0.07336956521739131, "endMs": "1665776843235", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.024456521739130436, "readRatioMax": 0.024456521739130436, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "42", "startMs": "1665776843199", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002717391304347826, "waitRatioMax": 0.002717391304347826, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.021739130434782608, "writeRatioMax": 0.021739130434782608 }, { "completedParallelInputs": "1", "computeMsAvg": "368", "computeMsMax": "368", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776843468", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "13", "readMsMax": "13", "readRatioAvg": 0.035326086956521736, "readRatioMax": 0.035326086956521736, "recordsRead": "724738", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "324", "startMs": "1665776843254", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002717391304347826, "waitRatioMax": 0.002717391304347826, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.019021739130434784, "writeRatioMax": 0.019021739130434784 }, { "completedParallelInputs": "1", "computeMsAvg": "16", "computeMsMax": "16", "computeRatioAvg": 0.043478260869565216, "computeRatioMax": 0.043478260869565216, "endMs": "1665776843501", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665776843484", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002717391304347826, "waitRatioMax": 0.002717391304347826, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.010869565217391304, "writeRatioMax": 0.010869565217391304 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.029891304347826088, "computeRatioMax": 0.029891304347826088, "endMs": "1665776843556", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776843519", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002717391304347826, "waitRatioMax": 0.002717391304347826, "writeMsAvg": "16", "writeMsMax": "16", "writeRatioAvg": 0.043478260869565216, "writeRatioMax": 0.043478260869565216 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "25", "computeRatioAvg": 0.021739130434782608, "computeRatioMax": 0.06793478260869565, "endMs": "1665776843618", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "2608", "startMs": "1665776843568", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.005434782608695652, "waitRatioMax": 0.008152173913043478, "writeMsAvg": "15", "writeMsMax": "26", "writeRatioAvg": 0.04076086956521739, "writeRatioMax": 0.07065217391304347 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.021739130434782608, "computeRatioMax": 0.04891304347826087, "endMs": "1665776843619", "id": "8", "inputStages": [ "7", "4" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "280723", "shuffleOutputBytesSpilled": "0", "slotMs": "2247", "startMs": "1665776843575", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "4", "waitMsMax": "6", "waitRatioAvg": 0.010869565217391304, "waitRatioMax": 0.016304347826086956, "writeMsAvg": "13", "writeMsMax": "28", "writeRatioAvg": 0.035326086956521736, "writeRatioMax": 0.07608695652173914 }, { "completedParallelInputs": "1", "computeMsAvg": "25", "computeMsMax": "25", "computeRatioAvg": 0.06793478260869565, "computeRatioMax": 0.06793478260869565, "endMs": "1665776843658", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "100", "shuffleOutputBytes": "20187", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776843588", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002717391304347826, "waitRatioMax": 0.002717391304347826, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.02717391304347826, "writeRatioMax": 0.02717391304347826 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "207", "elapsedMs": "603", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "5307" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "27095883", "totalPartitionsProcessed": "0", "totalSlotMs": "5307", "transferredBytes": "0" }, "startTime": "1665776843084", "totalBytesProcessed": "27095883", "totalSlotMs": "5307" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anonf7cf1c34_020e_491f_aeb7_4da72ae075fe" }, "priority": "INTERACTIVE", "query": "-- start query 12 in stream 0 using template query12.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ws_ext_sales_price) as itemrevenue \n ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n \t,item \n \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n \tand i_category in ('Sports', 'Books', 'Home')\n \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100\n;\n\n-- end query 12 in stream 0 using template query12.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "B7tcY+g0KVS3Ta4jADqo8Q==", "id": "test-project-364309:europe-west1.query12_1665776844", "jobReference": { "jobId": "query12_1665776844", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query12_1665776844?location=europe-west1", "statistics": { "creationTime": "1665776845343", "endTime": "1665776846035", "finalExecutionDurationMs": "513", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "27095883", "performanceInsights": { "avgPreviousExecutionMs": "488" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.044715447154471545, "computeRatioMax": 0.044715447154471545, "endMs": "1665776845498", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "5", "readMsMax": "5", "readRatioAvg": 0.02032520325203252, "readRatioMax": 0.02032520325203252, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665776845473", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "11", "writeMsMax": "11", "writeRatioAvg": 0.044715447154471545, "writeRatioMax": 0.044715447154471545 }, { "completedParallelInputs": "1", "computeMsAvg": "34", "computeMsMax": "34", "computeRatioAvg": 0.13821138211382114, "computeRatioMax": 0.13821138211382114, "endMs": "1665776845521", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "8", "readMsMax": "8", "readRatioAvg": 0.032520325203252036, "readRatioMax": 0.032520325203252036, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "45", "startMs": "1665776845486", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.032520325203252036, "writeRatioMax": 0.032520325203252036 }, { "completedParallelInputs": "1", "computeMsAvg": "246", "computeMsMax": "246", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776845730", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.08130081300813008, "readRatioMax": 0.08130081300813008, "recordsRead": "724738", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "249", "startMs": "1665776845540", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.016260162601626018, "writeRatioMax": 0.016260162601626018 }, { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.06097560975609756, "computeRatioMax": 0.06097560975609756, "endMs": "1665776845791", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "23", "startMs": "1665776845771", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "6", "writeMsMax": "6", "writeRatioAvg": 0.024390243902439025, "writeRatioMax": 0.024390243902439025 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.028455284552845527, "computeRatioMax": 0.028455284552845527, "endMs": "1665776845854", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "38", "startMs": "1665776845817", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0040650406504065045, "waitRatioMax": 0.0040650406504065045, "writeMsAvg": "18", "writeMsMax": "18", "writeRatioAvg": 0.07317073170731707, "writeRatioMax": 0.07317073170731707 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "16", "computeRatioAvg": 0.032520325203252036, "computeRatioMax": 0.06504065040650407, "endMs": "1665776845912", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3002", "startMs": "1665776845862", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.008130081300813009, "waitRatioMax": 0.008130081300813009, "writeMsAvg": "14", "writeMsMax": "19", "writeRatioAvg": 0.056910569105691054, "writeRatioMax": 0.07723577235772358 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "22", "computeRatioAvg": 0.036585365853658534, "computeRatioMax": 0.08943089430894309, "endMs": "1665776845935", "id": "8", "inputStages": [ "7", "4" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "280723", "shuffleOutputBytesSpilled": "0", "slotMs": "4467", "startMs": "1665776845866", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.012195121951219513, "waitRatioMax": 0.016260162601626018, "writeMsAvg": "40", "writeMsMax": "56", "writeRatioAvg": 0.16260162601626016, "writeRatioMax": 0.22764227642276422 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.04878048780487805, "computeRatioMax": 0.04878048780487805, "endMs": "1665776845945", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "100", "shuffleOutputBytes": "20187", "shuffleOutputBytesSpilled": "0", "slotMs": "16", "startMs": "1665776845874", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.012195121951219513, "waitRatioMax": 0.012195121951219513, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.02032520325203252, "writeRatioMax": 0.02032520325203252 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "completedUnits": "207", "elapsedMs": "598", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "7801" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "27095883", "totalPartitionsProcessed": "0", "totalSlotMs": "7801", "transferredBytes": "0" }, "startTime": "1665776845388", "totalBytesProcessed": "27095883", "totalSlotMs": "7801" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon917d5c0c_3e7e_4a19_9d32_d24447f2e915" }, "priority": "INTERACTIVE", "query": "-- start query 12 in stream 0 using template query12.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ws_ext_sales_price) as itemrevenue \n ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n \t,item \n \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n \tand i_category in ('Sports', 'Books', 'Home')\n \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100\n;\n\n-- end query 12 in stream 0 using template query12.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "snKFnXHashuDpRusP0SKZQ==", "id": "test-project-364309:europe-west1.query12_1665776847", "jobReference": { "jobId": "query12_1665776847", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query12_1665776847?location=europe-west1", "statistics": { "creationTime": "1665776847620", "endTime": "1665776848346", "finalExecutionDurationMs": "546", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "27095883", "performanceInsights": { "avgPreviousExecutionMs": "490" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.03597122302158273, "computeRatioMax": 0.03597122302158273, "endMs": "1665776847786", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.02158273381294964, "readRatioMax": 0.02158273381294964, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "29", "startMs": "1665776847752", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.025179856115107913, "writeRatioMax": 0.025179856115107913 }, { "completedParallelInputs": "1", "computeMsAvg": "47", "computeMsMax": "47", "computeRatioAvg": 0.16906474820143885, "computeRatioMax": 0.16906474820143885, "endMs": "1665776847833", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "20", "readMsMax": "20", "readRatioAvg": 0.07194244604316546, "readRatioMax": 0.07194244604316546, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "85", "startMs": "1665776847768", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035971223021582736, "waitRatioMax": 0.0035971223021582736, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.050359712230215826, "writeRatioMax": 0.050359712230215826 }, { "completedParallelInputs": "1", "computeMsAvg": "278", "computeMsMax": "278", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776848025", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "15", "readMsMax": "15", "readRatioAvg": 0.0539568345323741, "readRatioMax": 0.0539568345323741, "recordsRead": "724738", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "205", "startMs": "1665776847847", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0035971223021582736, "waitRatioMax": 0.0035971223021582736, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.02877697841726619, "writeRatioMax": 0.02877697841726619 }, { "completedParallelInputs": "1", "computeMsAvg": "18", "computeMsMax": "18", "computeRatioAvg": 0.06474820143884892, "computeRatioMax": 0.06474820143884892, "endMs": "1665776848120", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "33", "startMs": "1665776848084", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "14", "writeMsMax": "14", "writeRatioAvg": 0.050359712230215826, "writeRatioMax": 0.050359712230215826 }, { "completedParallelInputs": "1", "computeMsAvg": "5", "computeMsMax": "5", "computeRatioAvg": 0.017985611510791366, "computeRatioMax": 0.017985611510791366, "endMs": "1665776848189", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "36", "startMs": "1665776848151", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.0683453237410072, "writeRatioMax": 0.0683453237410072 }, { "completedParallelInputs": "99", "computeMsAvg": "7", "computeMsMax": "13", "computeRatioAvg": 0.025179856115107913, "computeRatioMax": 0.046762589928057555, "endMs": "1665776848243", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3447", "startMs": "1665776848196", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "3", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.01079136690647482, "writeMsAvg": "15", "writeMsMax": "19", "writeRatioAvg": 0.0539568345323741, "writeRatioMax": 0.0683453237410072 }, { "completedParallelInputs": "101", "computeMsAvg": "8", "computeMsMax": "17", "computeRatioAvg": 0.02877697841726619, "computeRatioMax": 0.06115107913669065, "endMs": "1665776848243", "id": "8", "inputStages": [ "4", "7" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "280723", "shuffleOutputBytesSpilled": "0", "slotMs": "2626", "startMs": "1665776848201", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "3", "waitMsMax": "4", "waitRatioAvg": 0.01079136690647482, "waitRatioMax": 0.014388489208633094, "writeMsAvg": "12", "writeMsMax": "19", "writeRatioAvg": 0.04316546762589928, "writeRatioMax": 0.0683453237410072 }, { "completedParallelInputs": "1", "computeMsAvg": "11", "computeMsMax": "11", "computeRatioAvg": 0.039568345323741004, "computeRatioMax": 0.039568345323741004, "endMs": "1665776848256", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "100", "shuffleOutputBytes": "20187", "shuffleOutputBytesSpilled": "0", "slotMs": "21", "startMs": "1665776848212", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.007194244604316547, "waitRatioMax": 0.007194244604316547, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.014388489208633094, "writeRatioMax": 0.014388489208633094 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "205", "elapsedMs": "591", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "6365" }, { "activeUnits": "1", "completedUnits": "206", "elapsedMs": "630", "estimatedRunnableUnits": "0", "pendingUnits": "1", "totalSlotMs": "6386" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "27095883", "totalPartitionsProcessed": "0", "totalSlotMs": "6386", "transferredBytes": "0" }, "startTime": "1665776847661", "totalBytesProcessed": "27095883", "totalSlotMs": "6386" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon99c9dad3_967c_4776_8212_4619913c779a" }, "priority": "INTERACTIVE", "query": "-- start query 12 in stream 0 using template query12.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ws_ext_sales_price) as itemrevenue \n ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n \t,item \n \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n \tand i_category in ('Sports', 'Books', 'Home')\n \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100\n;\n\n-- end query 12 in stream 0 using template query12.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "KC4OB3wiKOjiC7vs+xEYTg==", "id": "test-project-364309:europe-west1.query12_1665776849", "jobReference": { "jobId": "query12_1665776849", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query12_1665776849?location=europe-west1", "statistics": { "creationTime": "1665776850006", "endTime": "1665776850857", "finalExecutionDurationMs": "628", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "27095883", "performanceInsights": { "avgPreviousExecutionMs": "495" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.03289473684210526, "computeRatioMax": 0.03289473684210526, "endMs": "1665776850190", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013157894736842105, "readRatioMax": 0.013157894736842105, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "39", "startMs": "1665776850152", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021929824561403508, "waitRatioMax": 0.0021929824561403508, "writeMsAvg": "13", "writeMsMax": "13", "writeRatioAvg": 0.02850877192982456, "writeRatioMax": 0.02850877192982456 }, { "completedParallelInputs": "1", "computeMsAvg": "39", "computeMsMax": "39", "computeRatioAvg": 0.08552631578947369, "computeRatioMax": 0.08552631578947369, "endMs": "1665776850219", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "10", "readMsMax": "10", "readRatioAvg": 0.021929824561403508, "readRatioMax": 0.021929824561403508, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "55", "startMs": "1665776850177", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021929824561403508, "waitRatioMax": 0.0021929824561403508, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.021929824561403508, "writeRatioMax": 0.021929824561403508 }, { "completedParallelInputs": "1", "computeMsAvg": "456", "computeMsMax": "456", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776850507", "id": "3", "inputStages": [ "1", "0" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "16", "readMsMax": "16", "readRatioAvg": 0.03508771929824561, "readRatioMax": 0.03508771929824561, "recordsRead": "724738", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "329", "startMs": "1665776850237", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021929824561403508, "waitRatioMax": 0.0021929824561403508, "writeMsAvg": "12", "writeMsMax": "12", "writeRatioAvg": 0.02631578947368421, "writeRatioMax": 0.02631578947368421 }, { "completedParallelInputs": "1", "computeMsAvg": "12", "computeMsMax": "12", "computeRatioAvg": 0.02631578947368421, "computeRatioMax": 0.02631578947368421, "endMs": "1665776850581", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "26", "startMs": "1665776850559", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.0021929824561403508, "waitRatioMax": 0.0021929824561403508, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.015350877192982455, "writeRatioMax": 0.015350877192982455 }, { "completedParallelInputs": "1", "computeMsAvg": "10", "computeMsMax": "10", "computeRatioAvg": 0.021929824561403508, "computeRatioMax": 0.021929824561403508, "endMs": "1665776850653", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776850613", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "2", "waitMsMax": "2", "waitRatioAvg": 0.0043859649122807015, "waitRatioMax": 0.0043859649122807015, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.041666666666666664, "writeRatioMax": 0.041666666666666664 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "18", "computeRatioAvg": 0.017543859649122806, "computeRatioMax": 0.039473684210526314, "endMs": "1665776850723", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3763", "startMs": "1665776850667", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.010964912280701754, "writeMsAvg": "21", "writeMsMax": "32", "writeRatioAvg": 0.046052631578947366, "writeRatioMax": 0.07017543859649122 }, { "completedParallelInputs": "101", "computeMsAvg": "10", "computeMsMax": "20", "computeRatioAvg": 0.021929824561403508, "computeRatioMax": 0.043859649122807015, "endMs": "1665776850735", "id": "8", "inputStages": [ "4", "7" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "280723", "shuffleOutputBytesSpilled": "0", "slotMs": "3941", "startMs": "1665776850674", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "6", "waitMsMax": "12", "waitRatioAvg": 0.013157894736842105, "waitRatioMax": 0.02631578947368421, "writeMsAvg": "14", "writeMsMax": "27", "writeRatioAvg": 0.03070175438596491, "writeRatioMax": 0.05921052631578947 }, { "completedParallelInputs": "1", "computeMsAvg": "6", "computeMsMax": "6", "computeRatioAvg": 0.013157894736842105, "computeRatioMax": 0.013157894736842105, "endMs": "1665776850738", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "100", "shuffleOutputBytes": "20187", "shuffleOutputBytesSpilled": "0", "slotMs": "60", "startMs": "1665776850687", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "3", "waitMsMax": "3", "waitRatioAvg": 0.006578947368421052, "waitRatioMax": 0.006578947368421052, "writeMsAvg": "4", "writeMsMax": "4", "writeRatioAvg": 0.008771929824561403, "writeRatioMax": 0.008771929824561403 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "2", "completedUnits": "4", "elapsedMs": "603", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "467" }, { "activeUnits": "2", "completedUnits": "207", "elapsedMs": "722", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8143" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "27095883", "totalPartitionsProcessed": "0", "totalSlotMs": "8143", "transferredBytes": "0" }, "startTime": "1665776850051", "totalBytesProcessed": "27095883", "totalSlotMs": "8143" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
{ "configuration": { "jobType": "QUERY", "query": { "defaultDataset": { "datasetId": "call_center", "projectId": "test-project-364309" }, "destinationTable": { "datasetId": "_a0aa936c5cea243efb3c6dc011c66cfad39bfcb7", "projectId": "test-project-364309", "tableId": "anon22dfa2e0_612e_4ab0_8eed_af885d13ef53" }, "priority": "INTERACTIVE", "query": "-- start query 12 in stream 0 using template query12.tpl\nselect i_item_id\n ,i_item_desc \n ,i_category \n ,i_class \n ,i_current_price\n ,sum(ws_ext_sales_price) as itemrevenue \n ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n \t,item \n \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n \tand i_category in ('Sports', 'Books', 'Home')\n \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('1999-02-22' as date) \n\t\t\t\tand (cast('1999-02-22' + 30 as date))\ngroup by \n\ti_item_id\n ,i_item_desc \n ,i_category\n ,i_class\n ,i_current_price\norder by \n\ti_category\n ,i_class\n ,i_item_id\n ,i_item_desc\n ,revenueratio\nlimit 100\n;\n\n-- end query 12 in stream 0 using template query12.tpl", "useLegacySql": false, "useQueryCache": false, "writeDisposition": "WRITE_TRUNCATE" } }, "etag": "TdYNz2NIooUC1YkNsgpR3w==", "id": "test-project-364309:europe-west1.query12_1665776851", "jobReference": { "jobId": "query12_1665776851", "location": "europe-west1", "projectId": "test-project-364309" }, "kind": "bigquery#job", "principal_subject": "user:jesuispotatos@gmail.com", "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/test-project-364309/jobs/query12_1665776851?location=europe-west1", "statistics": { "creationTime": "1665776852456", "endTime": "1665776853419", "finalExecutionDurationMs": "774", "query": { "billingTier": 1, "cacheHit": false, "estimatedBytesProcessed": "27095883", "performanceInsights": { "avgPreviousExecutionMs": "504" }, "queryPlan": [ { "completedParallelInputs": "1", "computeMsAvg": "15", "computeMsMax": "15", "computeRatioAvg": 0.03496503496503497, "computeRatioMax": 0.03496503496503497, "endMs": "1665776852626", "id": "0", "name": "S00: Input", "parallelInputs": "1", "readMsAvg": "6", "readMsMax": "6", "readRatioAvg": 0.013986013986013986, "readRatioMax": 0.013986013986013986, "recordsRead": "73049", "recordsWritten": "31", "shuffleOutputBytes": "279", "shuffleOutputBytesSpilled": "0", "slotMs": "41", "startMs": "1665776852592", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$10:d_date_sk, $11:d_date", "FROM date_dim", "WHERE between($11, 10644, 10674)" ] }, { "kind": "WRITE", "substeps": [ "$10", "TO __stage00_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.002331002331002331, "writeMsAvg": "7", "writeMsMax": "7", "writeRatioAvg": 0.016317016317016316, "writeRatioMax": 0.016317016317016316 }, { "completedParallelInputs": "1", "computeMsAvg": "31", "computeMsMax": "31", "computeRatioAvg": 0.07226107226107226, "computeRatioMax": 0.07226107226107226, "endMs": "1665776852650", "id": "1", "name": "S01: Input", "parallelInputs": "1", "readMsAvg": "9", "readMsMax": "9", "readRatioAvg": 0.02097902097902098, "readRatioMax": 0.02097902097902098, "recordsRead": "18000", "recordsWritten": "5323", "shuffleOutputBytes": "927990", "shuffleOutputBytesSpilled": "0", "slotMs": "46", "startMs": "1665776852611", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category", "FROM item", "WHERE in($25, 'Sports', 'Books', 'Home')" ] }, { "kind": "WRITE", "substeps": [ "$20, $21, $22, $23, $24, $25", "TO __stage01_output" ] } ], "waitMsAvg": "5", "waitMsMax": "5", "waitRatioAvg": 0.011655011655011656, "waitRatioMax": 0.011655011655011656, "writeMsAvg": "8", "writeMsMax": "8", "writeRatioAvg": 0.018648018648018648, "writeRatioMax": 0.018648018648018648 }, { "completedParallelInputs": "1", "computeMsAvg": "429", "computeMsMax": "429", "computeRatioAvg": 1, "computeRatioMax": 1, "endMs": "1665776852947", "id": "3", "inputStages": [ "0", "1" ], "name": "S03: Join+", "parallelInputs": "1", "readMsAvg": "31", "readMsMax": "31", "readRatioAvg": 0.07226107226107226, "readRatioMax": 0.07226107226107226, "recordsRead": "724738", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "474", "startMs": "1665776852664", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_sales_price", "FROM web_sales" ] }, { "kind": "READ", "substeps": [ "$20, $21, $22, $23, $24, $25", "FROM __stage01_output" ] }, { "kind": "READ", "substeps": [ "$10", "FROM __stage00_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $200 := $191, $201 := $192, $202 := $195, $203 := $194, $204 := $193", "$110 := SUM($190)" ] }, { "kind": "JOIN", "substeps": [ "$190 := $181, $191 := $182, $192 := $183, $193 := $184, $194 := $185, $195 := $186", "INNER HASH JOIN EACH WITH ALL ON $180 = $10" ] }, { "kind": "JOIN", "substeps": [ "$180 := $1, $181 := $3, $182 := $21, $183 := $22, $184 := $23, $185 := $24, $186 := $25", "INNER HASH JOIN EACH WITH ALL ON $2 = $20" ] }, { "kind": "WRITE", "substeps": [ "$200, $201, $204, $203, $202, $110", "TO __stage03_output", "BY HASH($200, $201, $202, $203, $204)" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.002331002331002331, "writeMsAvg": "10", "writeMsMax": "10", "writeRatioAvg": 0.023310023310023312, "writeRatioMax": 0.023310023310023312 }, { "completedParallelInputs": "1", "computeMsAvg": "14", "computeMsMax": "14", "computeRatioAvg": 0.03263403263403263, "computeRatioMax": 0.03263403263403263, "endMs": "1665776853053", "id": "4", "inputStages": [ "3" ], "name": "S04: Aggregate", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "256804", "shuffleOutputBytesSpilled": "0", "slotMs": "20", "startMs": "1665776853030", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$200, $201, $204, $203, $202, $110", "FROM __stage03_output" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203, $214 := $204", "$70 := SUM($110)" ] }, { "kind": "WRITE", "substeps": [ "$210, $211, $214, $213, $212, $70", "TO __stage04_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.002331002331002331, "writeMsAvg": "5", "writeMsMax": "5", "writeRatioAvg": 0.011655011655011656, "writeRatioMax": 0.011655011655011656 }, { "completedParallelInputs": "1", "computeMsAvg": "7", "computeMsMax": "7", "computeRatioAvg": 0.016317016317016316, "computeRatioMax": 0.016317016317016316, "endMs": "1665776853127", "id": "5", "name": "S05: Input", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "37", "startMs": "1665776853089", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$160, $250", "FROM __SHUFFLE3" ] }, { "kind": "COMPUTE", "substeps": [ "$100 := coalesce($260, '')", "$101 := coalesce($260, '0')" ] }, { "kind": "AGGREGATE", "substeps": [ "GROUP BY $260 := $250", "$150 := SUM($160)" ] }, { "kind": "WRITE", "substeps": [ "$100, $101, $150", "TO __stage05_output" ] } ], "waitMsAvg": "1", "waitMsMax": "1", "waitRatioAvg": 0.002331002331002331, "waitRatioMax": 0.002331002331002331, "writeMsAvg": "19", "writeMsMax": "19", "writeRatioAvg": 0.04428904428904429, "writeRatioMax": 0.04428904428904429 }, { "completedParallelInputs": "100", "computeMsAvg": "8", "computeMsMax": "20", "computeRatioAvg": 0.018648018648018648, "computeRatioMax": 0.046620046620046623, "endMs": "1665776853206", "id": "7", "inputStages": [ "5" ], "name": "S07: Coalesce", "parallelInputs": "100", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "0", "recordsWritten": "0", "shuffleOutputBytes": "0", "shuffleOutputBytesSpilled": "0", "slotMs": "3898", "startMs": "1665776853147", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "FROM __stage05_output" ] } ], "waitMsAvg": "3", "waitMsMax": "5", "waitRatioAvg": 0.006993006993006993, "waitRatioMax": 0.011655011655011656, "writeMsAvg": "18", "writeMsMax": "29", "writeRatioAvg": 0.04195804195804196, "writeRatioMax": 0.0675990675990676 }, { "completedParallelInputs": "101", "computeMsAvg": "9", "computeMsMax": "34", "computeRatioAvg": 0.02097902097902098, "computeRatioMax": 0.07925407925407925, "endMs": "1665776853235", "id": "8", "inputStages": [ "4", "7" ], "name": "S08: Join+", "parallelInputs": "101", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "1407", "shuffleOutputBytes": "280723", "shuffleOutputBytesSpilled": "0", "slotMs": "4310", "startMs": "1665776853157", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$210, $211, $214, $213, $212, $70", "FROM __stage04_output" ] }, { "kind": "READ", "substeps": [ "$130, $131, $132, $133, $134, $135", "FROM __SHUFFLE2" ] }, { "kind": "READ", "substeps": [ "$100, $101, $150", "FROM __stage07_output" ] }, { "kind": "SORT", "substeps": [ "$54 ASC, $53 ASC, $50 ASC, $51 ASC, $30 ASC", "LIMIT 100" ] }, { "kind": "COMPUTE", "substeps": [ "$30 := divide(multiply($56, NUMERIC<...>), $55)" ] }, { "kind": "ANALYTIC_FUNCTION", "substeps": [ "$60 := SUM($225) OVER (PARTITION BY $223 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)" ] }, { "kind": "SORT", "substeps": [ "$123 ASC" ] }, { "kind": "JOIN", "substeps": [ "$270 := $140, $271 := $141, $272 := $142, $273 := $143, $274 := $144, $275 := $145, $276 := $150", "INNER HASH JOIN EACH WITH ALL ON $90 = $100, $91 = $101" ] }, { "kind": "COMPUTE", "substeps": [ "$90 := coalesce($143, '')", "$91 := coalesce($143, '0')" ] }, { "kind": "WRITE", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "TO __stage08_output" ] } ], "waitMsAvg": "6", "waitMsMax": "9", "waitRatioAvg": 0.013986013986013986, "waitRatioMax": 0.02097902097902098, "writeMsAvg": "27", "writeMsMax": "64", "writeRatioAvg": 0.06293706293706294, "writeRatioMax": 0.14918414918414918 }, { "completedParallelInputs": "1", "computeMsAvg": "41", "computeMsMax": "41", "computeRatioAvg": 0.09557109557109557, "computeRatioMax": 0.09557109557109557, "endMs": "1665776853328", "id": "9", "inputStages": [ "8" ], "name": "S09: Output", "parallelInputs": "1", "readMsAvg": "0", "readMsMax": "0", "readRatioAvg": 0, "readRatioMax": 0, "recordsRead": "1407", "recordsWritten": "100", "shuffleOutputBytes": "20187", "shuffleOutputBytesSpilled": "0", "slotMs": "184", "startMs": "1665776853177", "status": "COMPLETE", "steps": [ { "kind": "READ", "substeps": [ "$280, $281, $282, $283, $284, $285, $286", "FROM __stage08_output" ] }, { "kind": "SORT", "substeps": [ "$285 ASC, $284 ASC, $281 ASC, $282 ASC, $280 ASC", "LIMIT 100" ] }, { "kind": "WRITE", "substeps": [ "$290, $291, $292, $293, $294, $295, $296", "TO __stage09_output" ] } ], "waitMsAvg": "8", "waitMsMax": "8", "waitRatioAvg": 0.018648018648018648, "waitRatioMax": 0.018648018648018648, "writeMsAvg": "27", "writeMsMax": "27", "writeRatioAvg": 0.06293706293706294, "writeRatioMax": 0.06293706293706294 } ], "referencedTables": [ { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "web_sales" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "item" }, { "datasetId": "call_center", "projectId": "test-project-364309", "tableId": "date_dim" } ], "statementType": "SELECT", "timeline": [ { "activeUnits": "1", "completedUnits": "4", "elapsedMs": "589", "estimatedRunnableUnits": "0", "pendingUnits": "2", "totalSlotMs": "582" }, { "activeUnits": "1", "completedUnits": "207", "elapsedMs": "864", "estimatedRunnableUnits": "0", "pendingUnits": "0", "totalSlotMs": "8876" } ], "totalBytesBilled": "31457280", "totalBytesProcessed": "27095883", "totalPartitionsProcessed": "0", "totalSlotMs": "8876", "transferredBytes": "0" }, "startTime": "1665776852503", "totalBytesProcessed": "27095883", "totalSlotMs": "8876" }, "status": { "state": "DONE" }, "user_email": "jesuispotatos@gmail.com" }
